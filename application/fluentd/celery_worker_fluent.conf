# <source>
#   @type tail
#   format json
#   read_from_head true
#   tag celery-worker-logs.log
#   path /fluentd/log/files/celery_worker_logs.log
#   pos_file /tmp/celery_worker_logs.log.pos
# </source>

<source>
  @type http
  port 9880
  bind fluentd
  tag celery-worker-logs.log
  body_size_limit 32m
  keepalive_timeout 10s
</source>


<filter celery-worker-logs.log>
  @type record_transformer
  <record>
    hostname "#{Socket.gethostname}"
    tag ${tag}
  </record>
</filter>

<match celery-worker-logs.log>
  @type elasticsearch
  host elasticsearch
  port 9200
  index_name fluentd-celery_worker
  type_name fluentd
</match>
